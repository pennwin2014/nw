<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<META HTTP-EQUIV="Expires" CONTENT="0">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Jon Eyrick" CONTENT="no-cache">
<title>网络接口图</title>
<style>
	v\:*         { behavior: url(#default#VML) }
o\:*         { behavior: url(#default#VML) }
.shape       { behavior: url(#default#VML) }
TD {	FONT-SIZE: 10pt}
</style>
<SCRIPT LANGUAGE="JavaScript">
	function getColor(){
		return "rgb("+Math.round(Math.random()*255)+","+Math.round(Math.random()*255)+","+Math.round(Math.random()*255)+")";
  };
	//求数据对象的最大Value
function maxs(mm){
 var max1 = 0;
 for(var i=0; i<mm.length; i++){
  if(parseInt(mm[i]) > max1) max1 = parseInt(mm[i]);
 }
 return max1;
}
	
	
</script>


</head>
<body topmargin=5 leftmargin=0 scroll=AUTO onload="parent.document.getElementById('flow_title').innerHTML='[#unit_title#]';">
	<div id="test1">

	<script LANGUAGE="JavaScript">	
	
	var tb_left=50;
	var tb_top=30;
	var tb_width=650;
	var tb_height=270;
	
	var y_tot=10;
	var x_tot=7;
	var y_max=0;
	
         //接口数
	
	var dev_desc=new Array();
	[#SLPB#]
	dev_desc[[#iNum#]]='[#devname#]';
	[#SLPE#]
	
	
	
	var dev_color=new Array();
	    dev_color[0]='#00FA9A';
	    dev_color[1]='#FF0000';
	    dev_color[2]='#1F00CD';
	    dev_color[3]='#bA00E6';
	    dev_color[4]='#00ffff';
	    dev_color[5]='#D2691E';
	    dev_color[6]='#800080';
	    dev_color[7]='#6B8E23';
		  dev_color[8]='#C0C0C0';
	    dev_color[9]='#FFFF00';
	    
	
	var sdate=new Array();
	[#SLPB#]
	 sdate[[#num#]]='[#sdate#]';
	[#SLPE#]
	
	[#SLPB#]
	var sdate_y[#iNum#]=new Array();
	[#SLPB#]
	sdate_y[#num#][[#num2#]]=[#data#];
	[#SLPE#]
	[#SLPE#]

	var dev_count=[#sum#];  
	var lCount=[#sum_d#];     //数据实际数量
	var temp_html;
	

//求数据中Y轴的最大数
var t_d=Array();
y_max=0;
for(var i=0;i<dev_count;i++){
	var obj="sdate_y"+i;
	var t_len=eval(obj).length;
	for(j=0;j<t_len;j++){
		if(i==0)
		t_d[j]=eval(obj)[j];
	else
		t_d[j]=t_d[j]+eval(obj)[j];

  }
}

y_max2=maxs(eval(t_d));


if(y_max2<10){
  y_max=10;

}
else if((y_max2<100)&&(y_max2>=10))
	 y_max=100;
else if(y_max2<1000&&y_max2>=100)
	 y_max=1000;
else if(y_max2<10000&&y_max2>=1000)
	y_max=10000;
else{
	
	y_max2=100*(1+(Math.round(maxs(eval(t_d))/100)));
	if(y_max2>y_max) y_max=y_max2;
 }

  


//y_max=[#maxrate#];



//var hh=Math.round(y_max/100)+1;
//  var t_m=hh+'';
//  y_max=Math.pow(10,parseInt(t_m.length));
//  y_max=100*hh;

  var step_scal=tb_height/y_tot;			
	var step=y_max/y_tot;
  x_tot=sdate.length;
	var step_x=Math.floor(tb_width/x_tot);
	var yzoom=tb_height/y_max;


   temp_html="<v:rect   style='position:absolute;left:"+tb_left+";top:"+tb_top+";width:"+tb_width+";height:"+tb_height+";z-index:-1' filled='f' fillcolor='#000000' strokecolor='#000000' strokeweight='1' stroked='t'>";
   temp_html=temp_html+"</v:rect>";
 
 //画边框  
   temp_html=temp_html+"<v:line   style='position:absolute;left:0;text-align:left;top:0;flip:y;z-index:2' from='"+parseInt(tb_left-1)+","+parseInt(tb_top-1)+"' to='"+parseInt(tb_left+tb_width+1)+","+parseInt(tb_top-1)+"'  strokecolor='#000000'/> ";
   temp_html=temp_html+"<v:line   style='position:absolute;left:0;text-align:left;top:0;flip:y;z-index:2' from='"+parseInt(tb_left-1)+","+parseInt(tb_top+tb_height+1)+"' to='"+parseInt(tb_left+tb_width+1)+","+parseInt(tb_top+tb_height+1)+"'  strokecolor='#000000'/> ";
   temp_html=temp_html+"<v:line   style='position:absolute;left:0;text-align:left;top:0;flip:y;z-index:2' from='"+parseInt(tb_left-1)+","+parseInt(tb_top-1)+"' to='"+parseInt(tb_left-1)+","+parseInt(tb_top+tb_height+1)+"'  strokecolor='#000000'/> "; 
   temp_html=temp_html+"<v:line   style='position:absolute;left:0;text-align:left;top:0;flip:y;z-index:2' from='"+parseInt(tb_left+tb_width+1)+","+parseInt(tb_top-1)+"' to='"+parseInt(tb_left+tb_width+1)+","+parseInt(tb_top+tb_height+1)+"'  strokecolor='#000000'/> ";  
      
//画Y轴	
	var i;
	for(i=0;i<=y_tot;i++){	   
			temp_html=temp_html+"<v:line  alt='' style='position:absolute;left:0;text-align:left;top:0;flip:y;z-index:-1' from='"+parseInt(tb_left)+","+parseInt(tb_top+step_scal*i)+"' to='"+parseInt(tb_left+tb_width)+","+parseInt(tb_top+step_scal*i)+"'  strokecolor='#dfdfdf' />	";		

		  temp_html=temp_html+"<v:shape  alt='' style='position:absolute;left:"+parseInt(tb_left-55)+";top:"+parseInt(tb_top+tb_height-i*step_scal-10)+";width:50px;height:18px;z-index:1'>";
		  temp_html=temp_html+"<v:textbox inset='0px,0px,0px,0px'>";
		  temp_html=temp_html+"<table cellspacing='3' cellpadding='0' width='100%' height='100%'>";	
		  temp_html=temp_html+"<tr><td align='right'>"+i*step+"111</td></tr>";
		  temp_html=temp_html+"</table></v:textbox></v:shape>";

				   
	}

		 temp_html=temp_html+"<v:shape   style='position:absolute;left:"+parseInt(tb_left-30)+";top:"+parseInt(tb_top+tb_height-i*step_scal-5)+";width:40px;height:18px;z-index:1'>";
		  temp_html=temp_html+"<v:textbox inset='0px,0px,0px,0px'>";
		  temp_html=temp_html+"<table cellspacing='3' cellpadding='0' width='100%' height='100%'>";	
		  temp_html=temp_html+"<tr><td align='right'>[#unit#]</td></tr>";
		  temp_html=temp_html+"</table></v:textbox></v:shape>"; 



//画X轴

 for(i=0;i<x_tot;i++){
 	
 		temp_html=temp_html+"<v:line  alt='' style='position:absolute;left:0;text-align:left;top:0;flip:y;z-index:1' from='"+parseInt(tb_left+i*tb_width/(x_tot-1))+","+parseInt(tb_top)+"' to='"+parseInt(tb_left+i*tb_width/(x_tot-1))+","+parseInt(tb_top+tb_height)+"' strokecolor='#dfdfdf'/>";			
	  temp_html=temp_html+"<v:shape  alt='' style='position:absolute;left:"+parseInt(tb_left+i*tb_width/(x_tot-1)-18)+";top:"+parseInt(tb_top+tb_height+7)+";width:25px;height:30px;z-index:8'>";

	  temp_html=temp_html+"<table cellspacing='0' cellpadding='0' width='100%' height='100%' style='FILTER: progid:DXImageTransform.Microsoft.BasicImage(Rotation=3);'>";	
	  temp_html=temp_html+"<tr><td align='left'  >"+sdate[i]+"</td></tr>";
	  temp_html=temp_html+"</table></v:shape>";
 	
}



//画线
var p1='';


var temp_data=new Array();
//初始化temp_data

for(i=0;i<sdate_y0.length;i++){
	temp_data[i]=0;
}



var minlen;
if(lCount<sdate_y0.length) 
   minlen=lCount;
else
	 minlen=sdate_y0.length;


for(j=0;j<dev_count;j++){
	var obj_y1,obj1;
	var obj="sdate_y"+j;

	if(j>0)
	 obj1="sdate_y"+(parseInt(j-1));
	 

	var obj_y=eval(obj);
	if(j>0)
	  obj_y1=eval(obj1);
	  
	var y_len=eval(obj).length;
 

p1="";
  for(i=0;i<minlen;i++){
  	
  	   if(i==0){    
            
            p1=parseInt(tb_left+i*tb_width/(y_len-1))+','+parseInt(tb_top+tb_height-(temp_data[i]+obj_y[i])*yzoom);   
               
         }
//        if(i==lCount){
        
//        		p1=p1+','+parseInt(tb_left+(i-1)*tb_width/(y_len-1))+','+parseInt(tb_top+tb_height-(temp_data[i]+obj_y[i])*yzoom);
//        }
        else{

	       	 p1=p1+','+parseInt(tb_left+i*tb_width/(y_len-1))+','+parseInt(tb_top+tb_height-(temp_data[i]+obj_y[i])*yzoom);
	       	 
  	   }
  	
  }
		  	
  

//曲线下半部分
 for(i=0;i<minlen;i++){
 	 	                                 
    	   p1=p1+','+parseInt(tb_left+(minlen-1-i)*tb_width/(y_len-1))+','+parseInt(tb_top+tb_height-(temp_data[(minlen-1-i)])*yzoom);
   
    
  }
 

  
  
   for(i=0;i<=y_len-1;i++){
  	if(j==0){
  		temp_data[i]=obj_y[i];
  	}
  	else
  	  temp_data[i]=temp_data[i]+obj_y[i]; 
  }
  

    temp_html=temp_html+'<v:polyline style="Z-INDEX:1;LEFT:0;POSITION:absolute;TOP:0"  points=" '+p1+'" filled="t" fillcolor="'+dev_color[j]+'" strokecolor="'+dev_color[j]+'" />';

  
  
}



//画图例

   var mmm=0;
   for(i=0;i<dev_count;i++){
//			var indev='['+dev_desc[i]+']';
//			if(alldev.indexOf(indev)!=-1){
      temp_html=temp_html+"<v:rect style='position:absolute;left:"+parseInt(tb_left+tb_width+8)+";top:"+parseInt(tb_top+mmm*30+6)+";width:16;height:12;z-index:-1' fillcolor='"+dev_color[i]+"' strokecolor='"+dev_color[i]+"' strokeweight='1' stroked='t'></v:rect>";
      
      temp_html=temp_html+"<v:shape  style='position:absolute;left:"+parseInt(tb_left+tb_width+28)+";top:"+parseInt(tb_top+mmm*30+3)+";width:60px;height:18px;z-index:1'>";

		  temp_html=temp_html+"<table cellspacing='3' cellpadding='0' width='100%' height='100%'>";	
		  temp_html=temp_html+"<tr><td align='left'>"+dev_desc[i]+"</td></tr>";
		  temp_html=temp_html+"</table></v:shape>";
		  mmm++;
//     }
   }
//alert(temp_html);


  document.write(temp_html);
</script>
	


	
	
	
	
	
	
	
	
	
	
	
	
	
	
</div>
	
</body>