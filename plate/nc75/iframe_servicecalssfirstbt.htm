

<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">

<style>
v\:*         { behavior: url(#default#VML) }
o\:*         { behavior: url(#default#VML) }
.shape       { behavior: url(#default#VML) }

.style4 {color: #00237e; font-size: 13px; font-weight: bold; }
</style>

<head>
	<META HTTP-EQUIV="Expires" CONTENT="0">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Jon Eyrick" CONTENT="no-cache">
	 <meta name="GENERATOR" content="Microsoft Visual Studio .NET 7.1">
  <meta name="ProgId" content="VisualStudio.HTML">
  <meta name="Originator" content="Microsoft Visual Studio .NET 7.1">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>网络服务图表</title>
<style>
A:link{
color:#000000;text-decoration:none;
font-size:9pt;
}
A:visited{
color:#000000;text-decoration:none;
font-size:9pt;
}
A:hover{color:#000000;text-decoration:underline;
font-size:9pt;
}
A:active{color:#000000;text-decoration:underline;
font-size:9pt;
}
	
	
TD {	FONT-SIZE: 9pt}
</style>

	<script LANGUAGE="JavaScript">	
	function openreport(t){

		window.open(t,'open_report','height=600, width=900, top=0, left=0,toolbar=no,scrollbars=no,resizable=1,menubar=no,status=no;');
	}
	
	
	
	var tb_left=10;
	var tb_top=37;
	var tb_width=160;
	var tb_height=150;
	var path_s="m"+parseInt(tb_width/2)+","+parseInt(tb_height/2)+"ae"+parseInt(tb_width/2)+","+parseInt(tb_height/2)+","+parseInt(tb_width/2)+","+parseInt(tb_height/2)+",";
  var startAng=0;
  var endAng=0;
		var dev_color=new Array();
	    dev_color[0]='#00FA9A';
	    dev_color[1]='#FF0000';
	    dev_color[2]='#00EBCD';
	    dev_color[3]='#A52A2A';
	    dev_color[4]='#778899';
	    dev_color[5]='#e2691E';
	    dev_color[6]='#800080';
	    dev_color[7]='#6B8E23';
		  dev_color[8]='#C0C0C0';
	    dev_color[9]='#FFFF00';
	    dev_color[10]='#FF00ff';
//	alert(Math.cos(180*Math.PI/180));
//	tb_width*Math.cos(sdata[i]/tot*2*Math.PI)+tb_width*Math.cos(sdata[i]+
	
	var sdata_desc=new Array();
	var sdata_rat=new Array();
	var sdata=new Array();
  var sdata_time=new Array();
  var sdata_service=new Array();
  
	[#SLPB#]
	sdata_rat[[#num#]]='[#rate#]%';
	sdata_desc[[#num#]]='[#name#]';
	sdata[[#num#]]=[#bytes#];
	sdata_time[[#num#]]=[#ltime#];
	sdata_service[[#num#]]=[#groupid#];
	[#SLPE#]
	
	var tot=0;
	var i;

	for(i=0;i<sdata.length;i++){
		tot=tot+sdata[i];
	}

	var mx=Math.pow(2,16)*360;


	
	
	var temp_html;
	

	
</script>



</head>


<body topmargin=5 leftmargin=0 style="overflow:hidden" onload="parent.form1.ctime.value='[#today#]';">
<div id="test1">

<script>
//统计小角度服务的数量	
small_count=0;
	for(i=0;i<sdata.length;i++){	
		var pieAng=sdata[i]/tot;	
		if((pieAng*360<=20)&&(pieAng*360>3.0))
		   small_count++;
	}
	
	
	var cx=20;
	var cy=10;
	var m_m=0;
	var n_n=0;
	temp_html="<v:oval  style='position:absolute;left:"+tb_left+";top:"+tb_top+";width:"+tb_width+";height:"+tb_height+"' fillcolor='#d5dbfb'>";
	temp_html=temp_html+"<v:fill color2='#dddddd' rotate='t' angle='-135' type='gradient'/>";
	temp_html=temp_html+"	<o:extrusion v:ext='view' backdepth='1in' viewpoint='0,34.72222mm'   viewpointorigin='0,.5' skewangle='90' lightposition='-50000'   lightposition2='50000' type='perspective' color='#dddddd' on='t'/></v:oval>";
	
	for(i=0;i<sdata.length;i++){
	
		var pieAng=sdata[i]/tot;		
		endAng=pieAng;

if(pieAng>0.5){

  var xx=0;
  var yy=50;

}
else{
  var xx=(tb_width*Math.cos(startAng*2*Math.PI)+tb_width*Math.cos((startAng+pieAng)*2*Math.PI))/2*0.40;
  if(startAng<0.5&&pieAng>0.3)
     var yy=(tb_height*Math.sin(startAng*2*Math.PI)+tb_height*Math.sin((startAng+pieAng)*2*Math.PI))/2*0.75;
  else
  var yy=(tb_height*Math.sin(startAng*2*Math.PI)+tb_height*Math.sin((startAng+pieAng)*2*Math.PI))/2*0.40;
}

  var xx_end=(tb_width*Math.cos(startAng*2*Math.PI)+tb_width*Math.cos((startAng+pieAng)*2*Math.PI))/2*0.6;
  var yy_end=(tb_height*Math.sin(startAng*2*Math.PI)+tb_height*Math.sin((startAng+pieAng)*2*Math.PI))/2*0.6;





	temp_html=temp_html+"<v:shape style='position:absolute;left:"+tb_left+";top:"+tb_top+";width:"+tb_width+";height:"+tb_height+";z-index:1' coordsize='"+tb_width+","+tb_height+"' o:spt='100' adj='0,,0' path='"+path_s+parseInt(mx*startAng)+","+parseInt(mx*endAng)+"xe' fillcolor='"+dev_color[i]+"' strokecolor='#FFFFFF' title='"+sdata_desc[i]+":"+sdata_rat[i]+"' >";
	temp_html=temp_html+"	<v:fill color2='"+dev_color[i]+"' rotate='t' focus='100%' type='gradient'/><v:stroke joinstyle='round'/><v:formulas/>";
	temp_html=temp_html+"<v:path o:connecttype='segments'/></v:shape>";
	
	
	//画比例
	

	if(pieAng*360>20){

	   
			temp_html=temp_html+"<v:shape style='position:absolute;left:"+parseInt(tb_left+tb_width/2+xx-cx)+";top:"+parseInt(tb_top+tb_height/2-yy-cy)+";width:40px;height:18px;z-index:1'>";
		  temp_html=temp_html+"<table  width='100%' height='100%'>";	
		  temp_html=temp_html+"<tr><td align='left'>"+sdata_rat[i]+"</td></tr>";
		  temp_html=temp_html+"</table></v:shape>";
	
	}
	else if((startAng<0.75)&&(parseFloat(pieAng*360)>3)){

//	   temp_html=temp_html+"<v:line style='position:absolute;left:0;top:0;z-index:8' from='"+parseInt(tb_left+tb_width/2+xx)+","+parseInt(tb_top+tb_height/2-yy)+"' to='"+parseInt(tb_left+10)+","+parseInt(tb_top+tb_height+n_n*20)+"' strokecolor='#888888'/>";	
//			temp_html=temp_html+"<v:shape style='position:absolute;left:"+parseInt(tb_left-30)+";top:"+parseInt(tb_top+tb_height+n_n*20)+";width:40px;height:18px;z-index:1'>";

//		  temp_html=temp_html+"<table  width='100%' height='100%'>";	
//		  temp_html=temp_html+"<tr><td align='left'>"+sdata_rat[i]+"</td></tr>";
//		  temp_html=temp_html+"</table></v:shape>";
//	   n_n++;
	}
	else if(parseFloat(pieAng*360)>3.0){
//	   temp_html=temp_html+"<v:line style='position:absolute;left:0;top:0;z-index:8' from='"+parseInt(tb_left+tb_width/2+xx)+","+parseInt(tb_top+tb_height/2-yy)+"' to='"+parseInt(tb_left+tb_width+10)+","+parseInt(tb_top+tb_height/2+small_count*10-m_m*20)+"' strokecolor='#888888'/>";	
//			temp_html=temp_html+"<v:shape style='position:absolute;left:"+parseInt(tb_left+tb_width+10)+";top:"+parseInt(tb_top+tb_height/2+small_count*10-m_m*20-12)+";width:40px;height:18px;z-index:1'>";

//		  temp_html=temp_html+"<table  width='100%' height='100%'>";	
//		  temp_html=temp_html+"<tr><td align='left'>"+sdata_rat[i]+"</td></tr>";
//		  temp_html=temp_html+"</table></v:shape>";
//	   m_m++;
	}
	
	
	
		 startAng+=pieAng;
	}



   var mmm=0;
 
//画图例

  for(i=0;i<sdata.length;i++){

      temp_html=temp_html+"<v:rect style='position:absolute;left:"+parseInt(tb_left+tb_width+12)+";top:"+parseInt(tb_top+mmm*18-22)+";width:16;height:12;z-index:-1' fillcolor='"+dev_color[i]+"' strokecolor='"+dev_color[i]+"' strokeweight='1' stroked='t'></v:rect>";
      
      temp_html=temp_html+"<v:shape  style='position:absolute;left:"+parseInt(tb_left+tb_width+32)+";top:"+parseInt(tb_top+mmm*18-25)+";width:140px;height:18px;z-index:1'>";

		  temp_html=temp_html+"<table cellspacing='3' cellpadding='0' width='100%' height='100%'>";	
		  temp_html=temp_html+"<tr><td align='left'> <a href='#xaa' onclick=openreport('/pronline/Msg?FunName@ncWebServiceFirstDet&flag@[#flag#]&stime@[#stime#]&etime@[#etime#]&service@"+sdata_service[i]+"') >"+sdata_desc[i]+"("+sdata_rat[i]+")"+"</a></td></tr>";
		  temp_html=temp_html+"</table></v:shape>";
		  mmm++;
     }
//画日期
      temp_html=temp_html+"<v:shape  style='position:absolute;left:"+parseInt(tb_left+10)+";top:"+parseInt(tb_top+tb_height+22)+";width:350px;height:16px;z-index:1'>";

		  temp_html=temp_html+"<table cellspacing='3' cellpadding='0' width='100%' height='100%'>";	
		  temp_html=temp_html+"<tr><td align='left'>"+"从[#endtime#]&nbsp;到[#today#](不包括正在连接的流量)"+"</td></tr>";
		  temp_html=temp_html+"</table></v:shape>";

//画标题
     temp_html=temp_html+"<v:shape  style='position:absolute;left:"+parseInt(tb_left+10)+";top:"+parseInt(tb_top-32)+";width:170px;height:18px;z-index:1'>";

		  temp_html=temp_html+"<table cellspacing='3' cellpadding='0' width='100%' height='100%'>";	
		  temp_html=temp_html+"<tr><td align='center' class='style4'>"+"[#title#]"+"</td></tr>";
		  temp_html=temp_html+"</table></v:shape>";


	document.write(temp_html);

</script>
</div>
</body>
</html> 