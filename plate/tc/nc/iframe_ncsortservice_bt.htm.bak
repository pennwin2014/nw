<!-- saved from url=(0022)http://internet.e-mail -->
<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office">
 <head>
  <title></title>
  <link rel="stylesheet" href="/css/css.css" type="text/css">
  <meta name="GENERATOR" content="Microsoft Visual Studio .NET 7.1">
  <meta name="ProgId" content="VisualStudio.HTML">
  <meta name="Originator" content="Microsoft Visual Studio .NET 7.1">
  <STYLE>v\:* { BEHAVIOR: url(#default#VML) }
 o\:* { BEHAVIOR: url(#default#VML) }
 .shape { BEHAVIOR: url(#default#VML) }
 </STYLE>
  <script language="javascript">
  	
function goto(t){
self.location.href=t
}
function lprint(){
  MM_showHideLayers('plabel','','hide')
  MM_showHideLayers('mybut','','hide')
  window.print()
  MM_showHideLayers('mybut','','show')
  MM_showHideLayers('plabel','','show')
}
function goto1(t){
 tt=showModalDialog(t, window, 'status:no;center:yes;help:no;minimize:no;maximize:yew;border:thick;statusbar:no;dialogWidth:550px;scroll:no;dialogHeight:500px');
}
function changeselect()
{
var fg;
	if(form1.group.value=="日"){
	fg="day"
	}else if(form1.group.value=="月"){
	fg="month"
	}
	else
	{
	fg="week"
	}
	if(form1.group.value=='9')
	document.all.xxm.rows[0].cells[1].innerHTML="&nbsp;<input type='text' name='sdate' value='[#sdate1#]' size='9' ><input type='text' name='stime' value='[#stime#]' size='1' maxlength='2' >&nbsp;到&nbsp;<input type='text' name='edate' value='[#sdate2#]' size='9' ><input type='text' name='etime' value='[#etime#]' size='1' maxlength='2' >";
	else
	{
	document.all.xxm.rows[0].cells[1].innerHTML="<img src='/images/pre"+fg+".gif' onclick=goto('/pronline/Msg?FunName@ncWebSortService&ltime@[#prev#]&group@[#group#]&order@[#order#]')><img src='/images/next"+fg+".gif' onClick=goto('/pronline/Msg?FunName@ncWebSortService&ltime@[#next#]&group@[#group#]&order@[#order#]')>";
	}
}
  	
  	
  	
 
  	
function Add(){
 var shape=document.createElement("v:shape");
 shape.type="#tooltipshape";
 shape.style.width="150px";
 shape.style.height="150px";
 shape.coordsize="21600,21600";
 shape.fillcolor="infobackground";
 
 var textbox=document.createElement("v:textbox");
 textbox.style.border="1px solid red";
 textbox.style.innerHTML="测试";
 shape.appendChild(textbox); 
 
 document.body.appendChild(shape);
}

function VMLPie(pContainer,pWidth,pHeight,pCaption){
 this.Container=pContainer;
 this.Width= pWidth || "400px";
 this.Height=pHeight || "250px";
 this.Caption = pCaption || "VML Chart";
 this.backgroundColor="";
 this.Shadow=false;
 this.BorderWidth=0;
 this.BorderColor=null;
 this.all=new Array();
 this.RandColor=function(){
  
  return "rgb("+ parseInt( Math.random() * 255) +"," +parseInt( Math.random() * 255) +"," +parseInt( Math.random() * 255)+")";
 }
 this.VMLObject=null;
}

VMLPie.prototype.Draw=function(){
 //画外框
  var o=document.createElement("v:group");
  o.style.width=this.Width;
  o.style.height=this.Height;
  o.coordsize="21600,21600";
 //添加一个背景层
  var vRect=document.createElement("v:rect");
  vRect.style.width="28600px"
  vRect.style.height="20500px"
  o.appendChild(vRect);
  
  var vCaption=document.createElement("v:textbox");
  vCaption.style.fontSize="24px";  
  vCaption.style.height="24px"
  vCaption.style.fontWeight="bold";
  vCaption.innerHTML=this.Caption;
  vCaption.style.textAlign="center";
  
  vRect.appendChild(vCaption);
 //设置边框大小 
  if(this.BorderWidth){
   vRect.strokeweight=this.BorderWidth;
  }
 //设置边框颜色
  if(this.BorderColor){
   vRect.strokecolor=this.BorderColor;
  }
 //设置背景颜色
  if(this.backgroundColor){  
   vRect.fillcolor=this.backgroundColor;
  }
 //设置是否出现阴影
  if(this.Shadow){
   var vShadow=document.createElement("v:shadow");
   vShadow.on="t";
   vShadow.type="single";
   vShadow.color="graytext";
   vShadow.offset="4px,4px";
   vRect.appendChild(vShadow);
  }
  this.VMLObject=o;
  this.Container.appendChild(o);
  
 //开始画内部园
  var oOval=document.createElement("v:oval");
  oOval.style.width="15000px";
  oOval.style.height="14000px";
  oOval.style.top="4000px";
  oOval.style.left="1000px";
  oOval.fillcolor="#d5dbfb";

  //var o3D=document.createElement("o:extrusion");
  var formatStyle=' <v:fill  rotate="t" angle="-135" focus="100%" type="gradient"/>';
  //formatStyle+='<o:extrusion v:ext="view" color="#9cf" on="t" rotationangle="-15"';
  //formatStyle+=' viewpoint="0,34.72222mm" viewpointorigin="0,.5" skewangle="105"';
  //formatStyle+=' lightposition="0,50000" lightposition2="0,-50000"/>';
  formatStyle+='<o:extrusion v:ext="view" backdepth="1in" on="t" viewpoint="0,34.72222mm"   viewpointorigin="0,.5" skewangle="90" lightposition="-50000"   lightposition2="50000" type="perspective"/>';
  oOval.innerHTML=formatStyle;  
  
  o.appendChild(oOval);
  this.CreatePie(o);  
  
}
VMLPie.prototype.CreatePie=function(vGroup){
  var mX=Math.pow(2,16) * 360;
  //这个参数是划图形的关键 
  //AE x y width height startangle endangle
  //x y表示圆心位置
  //width height形状的大小
  //startangle endangle的计算方法如下
  // 2^16 * 度数 
  
  var vTotal=0;
  var startAngle=0;
  var endAngle=0;
  var pieAngle=0;
  var prePieAngle=0;
  
  var objRow=null;
  var objCell=null;
  
  for(i=0;i<this.all.length;i++){
   vTotal+=this.all[i].Value;
  }
  
  var objLegendRect=document.createElement("v:rect");
  
  var objLegendTable=document.createElement("table");
  objLegendTable.cellPadding=0;
  objLegendTable.cellSpacing=3;
  objLegendTable.width="100%";
  with(objLegendRect){
   style.left="18000px";
   style.top="200px";
   style.width="10490px";
   style.height="20000px";
   fillcolor="#e6e6e6";
   strokeweight="1px";   
  }
  objRow=objLegendTable.insertRow();
  objCell=objRow.insertCell();
  objCell.colSpan="2";
  //objCell.style.border="1px outset";
  objCell.style.backgroundColor="black";
  objCell.style.padding="5px";
  objCell.style.color="window";
  objCell.style.font="caption";
  objCell.innerText="合计([#unit#]):"+Math.round(vTotal,3);
  
  
  var vTextbox=document.createElement("v:textbox");  
  vTextbox.appendChild(objLegendTable);
  objLegendRect.appendChild(vTextbox);
  
  var vShadow=document.createElement("v:shadow");
  vShadow.on="t";
  vShadow.type="single";
  vShadow.color="graytext";
  vShadow.offset="2px,2px";
  objLegendRect.appendChild(vShadow);
  
  
  vGroup.appendChild(objLegendRect);  

  
  var strAngle="";
  for(i=0;i<this.all.length;i++){ //顺序的划出各个饼图
   var vPieEl=document.createElement("v:shape");
   var vPieId=document.uniqueID;
   vPieEl.style.width="15000px";
   vPieEl.style.height="14000px";
   vPieEl.style.top="4000px";
   vPieEl.style.left="1000px";
   vPieEl.coordsize="1500,1400";
   vPieEl.strokecolor="white";   
   vPieEl.id=vPieId;
   
   pieAngle= this.all[i].Value / vTotal;
   startAngle+=prePieAngle;
   prePieAngle=pieAngle;
   endAngle=pieAngle; 
   
   //strAngle+=this.all[i].Name +":" +this.all[i].Value+ " Start:"+startAngle +"  End:"+ endAngle +"\n";
   
   vPieEl.path="M 750 700 AE 750 700 750 700 " + parseInt(mX * startAngle) +" " + parseInt(mX * endAngle) +" xe";
   vPieEl.title=this.all[i].Name +"\n所占比例:"+ endAngle * 100 +"%\n详细描述:" +this.all[i].TooltipText;
   
   //vPieEl.innerHTML='<v:fill  rotate="t" angle="-135" focus="100%" type="gradient"/>';
   var objFill=document.createElement("v:fill");
   objFill.rotate="t";
   objFill.focus="100%";
   objFill.type="gradient";
   objFill.angle=parseInt( 360 * (startAngle + endAngle /2));
   vPieEl.appendChild(objFill);
   
   var objTextbox=document.createElement("v:textbox");
   objTextbox.border="1px solid black";
   objTextbox.innerHTML=this.all[i].Name +":" + this.all[i].Value;
   //vPieEl.appendChild(objTextbox);
   
   var vColor=this.RandColor();
   vPieEl.fillcolor=vColor; //设置颜色
   //开始画图例
   objRow=objLegendTable.insertRow();
   objRow.style.height="16px";
   
   var objColor=objRow.insertCell();//颜色标记
   objColor.style.backgroundColor=vColor;
   objColor.style.width="16px";
   
   objColor.PieElement=vPieId;
   objColor.attachEvent("onmouseover",LegendMouseOverEvent);
   objColor.attachEvent("onmouseout",LegendMouseOutEvent);
   //objColor.onmouseover="LegendMouseOverEvent()";
   //objColor.onmouseout="LegendMouseOutEvent()";
   
   objCell=objRow.insertCell();
   objCell.style.font="icon";
   objCell.style.padding="3px";
   objCell.innerText=this.all[i].Name +":"+this.all[i].Value ;
   
   vGroup.appendChild(vPieEl);
  }
  
}
VMLPie.prototype.Refresh=function(){

}
VMLPie.prototype.Zoom=function (iValue){
 var vX=21600;
 var vY=21600;
 this.VMLObject.coordsize=parseInt(vX / iValue) +","+parseInt(vY /iValue);
}
VMLPie.prototype.AddData=function(sName,sValue,sTooltipText){

 var oData=new Object();
 oData.Name=sName;
 oData.Value=sValue;
 oData.TooltipText=sTooltipText;
 var iCount=this.all.length;
 this.all[iCount]=oData;

}
VMLPie.prototype.Clear=function(){
 this.all.length=0;
}
function LegendMouseOverEvent(){
 
 var eSrc=window.event.srcElement;
 eSrc.border="1px solid black";
}
function LegendMouseOutEvent(){
 var eSrc=window.event.srcElement;
 eSrc.border="";
}


var objPie=null;
//以下是函数调用
function DrawPie(){
	var temp_u='[#unit#]';
 objPie=new VMLPie(document.body,"600px","500px"," ");
//objPie.BorderWidth=1;
 //objPie.BorderColor="blue";
 //objPie.Width="800px";
 //objPie.Height="600px";
 objPie.backgroundColor="#ffffff";
 objPie.Shadow=false;
 [#SLPB#]
 if(temp_u=='KB')
 objPie.AddData("[#username#]",[#bytes#],"[#groupname#],[#username#]");
else
  objPie.AddData("[#username#]([#ctime#])",[#bytes#],"[#groupname#],[#username#]");
 [#SLPE#]

 objPie.Draw();
 //alert(document.body.outerHTML);
}

  </script>
 </head>
 <body onload="DrawPie()" bgcolor="#DEE8FA">
<form method="post" name="form1" id='interip' action="/pronline/Msg" >
<table border=0 cellspacing=0 cellpadding=0 width="100%"  align="center">
  <tr height="30"> 
    <td id=clearStart  valign="top" > 
      <div style="font-size:11pt;color:#00237e;font-weight:bold;text-align: center;" >
 <!--       <input type="button" name="Button" value="[#title_name#]Internet服务排行榜  日期:[#sdate1#]--[#sdate2#]" class="anniu100">         -->
     [#title_name#]Internet服务排行榜 日期:[#sdate1#]--[#sdate2#]
    &nbsp;&nbsp;&nbsp;&nbsp;报表类型&nbsp;<select name="rptype" ><option value="1">表格</option><option value="2">饼图</option></select>
 
      </div>
    </td>
  </tr>
  <tbody> 
  
  <tr>
    <td id=clearStart  valign="top"  > 
    
      <input type="hidden" name="FunName" value="ncWebSortService">
      <input type="hidden" name="ltime" value="[#current#]">
      <input type="hidden" name="userid" value="[#userid#]">
      <input type="hidden" name="groupid" value="[#groupid#]">
          <table border="0" align="center" cellpadding="0" cellspacing="0" width="100%" >
            <tr  > 
              <td height="30" colspan="5"   class="ttt" > 
                <table width="100%" border="0" id="xxm" >
                  <tr > 
                    <td width="415" height="21"> 
                      <div >排序
                      <select name="order" style="position:relative;top:-1px;">
                      <option value="流量">流量</option>
                      <option value="时间">时间</option>                                                
                      </select>  
                       [#sserv#]
                            统计时间 
                                                <select name="group" style="position:relative;top:-1px;" onchange="changeselect()">
                                                 <option value="周">周</option>
                                                 <option value="日">日</option>
                                                 <option value="月">月</option>
                                                 <option value="9">时间段</option>
                                                </select>&nbsp;显示<input name="sumrec" size="2" style="position:relative;top:-1px;" value="[#sumrec#]">&nbsp;行</div></td>

                    <td > 
                      <script>
			var fg
			if("[#group#]"=="日"){
			fg="day"
			}else if("[#group#]"=="月"){
			fg="month"
			}
			else if ("[#group#]"=="9"){
			fg="9";
			}
			else{
			fg="week"
			}
			if((fg=="day")||(fg=="month")||(fg=="week"))
			{
			document.write("<img src='/images/pre"+fg+".gif' onclick=goto('/pronline/Msg?FunName@ncWebSortService&ltime@[#prev#]&group@[#group#]&order@[#order#]&service@[#service#]&rptype@[#rptype#]')> ")
			document.write("<img src='/images/next"+fg+".gif' onClick=goto('/pronline/Msg?FunName@ncWebSortService&ltime@[#next#]&group@[#group#]&order@[#order#]&service@[#service#]&rptype@[#rptype#]')> ")
			}
			if(fg=="9")
			{
				document.write("&nbsp;<input type='text' name='sdate' value='[#sdate#]' size='9' ><input type='text' name='stime' value='[#stime#]' size='1' maxlength='2' >&nbsp;到&nbsp;<input type='text' name='edate' value='[#edate#]' size='9' ><input type='text' name='etime' value='[#etime#]' size='1' maxlength='2' >");
			}
                      </script>
                    </td>
                 
                    <td  >
                      <input type="button"  name="Search"  class="an3-0" value="查询" onclick="form1.submit()">

                     <input name="exp" type="submit" class="an3-0" value="导出">
                      <input name="save1" type="button" class="an3-0" onClick="lprint()"  value="打印">
                    </td>
                  </tr>
                </table>
              </td>
            </tr>
 </table>
  </form>
      <script>form1.group.value='[#group#]';
      form1.order.value='[#order#]';
      form1.rptype.value='[#rptype#]';
      </script>



 <div align="center">
  <v:shapetype id="tooltipshape" coordsize="21600,21600" o:spt="106" path=" ar0,7165,4345,13110,1950,7185,1080,12690 at475,11732,4835,17650,1080,12690,2910,17640 at2387,9757,10107,20300,2910,17640,8235,19545 at7660,12382,14412,21597,8235,19545,14280,18330 at12910,11080,18695,18947,14280,18330,18690,15045 at14822,5862,21597,15082,18690,15045,20895,7665 at15772,2592,21105,9865,20895,7665,19140,2715 at14330,0,19187,6595,19140,2715,14910,1170 at10992,0,15357,5945,14910,1170,11250,1665 at6692,650,12025,7917,11250,1665,7005,2580 at1912,1972,8665,11162,7005,2580,1950,7185 x e ar0,7165,4345,13110,1080,12690,2340,13080 nf e ar475,11732,4835,17650,2910,17640,3465,17445 nf e ar7660,12382,14412,21597,7905,18675,8235,19545 nf e ar7660,12382,14412,21597,14280,18330,14400,17370 nf e ar12910,11080,18695,18947,18690,15045,17070,11475 nf e ar15772,2592,21105,9865,20175,9015,20895,7665 nf e ar14330,0,19187,6595,19200,3345,19140,2715 nf e ar14330,0,19187,6595,14910,1170,14550,1980 nf e ar10992,0,15357,5945,11250,1665,11040,2340 nf e ar1912,1972,8665,11162,7650,3270,7005,2580 nf e ar1912,1972,8665,11162,1950,7185,2070,7890 nf e m@23@37 qx@35@24@23@36@34@24@23@37 x e m@16@33 qx@31@17@16@32@30@17@16@33 x e m@38@29 qx@27@39@38@28@26@39@38@29 x e"
   adj="1350,25920">
   <v:formulas>
    <v:f eqn="sum #0 0 10800 "></v:f>
    <v:f eqn="sum #1 0 10800 "></v:f>
    <v:f eqn="cosatan2 10800 @0 @1 "></v:f>
    <v:f eqn="sinatan2 10800 @0 @1 "></v:f>
    <v:f eqn="sum @2 10800 0 "></v:f>
    <v:f eqn="sum @3 10800 0 "></v:f>
    <v:f eqn="sum @4 0 #0 "></v:f>
    <v:f eqn="sum @5 0 #1 "></v:f>
    <v:f eqn="mod @6 @7 0 "></v:f>
    <v:f eqn="prod 600 11 1 "></v:f>
    <v:f eqn="sum @8 0 @9 "></v:f>
    <v:f eqn="prod @10 1 3 "></v:f>
    <v:f eqn="prod 600 3 1 "></v:f>
    <v:f eqn="sum @11 @12 0 "></v:f>
    <v:f eqn="prod @13 @6 @8 "></v:f>
    <v:f eqn="prod @13 @7 @8 "></v:f>
    <v:f eqn="sum @14 #0 0 "></v:f>
    <v:f eqn="sum @15 #1 0 "></v:f>
    <v:f eqn="prod 600 8 1 "></v:f>
    <v:f eqn="prod @11 2 1 "></v:f>
    <v:f eqn="sum @18 @19 0 "></v:f>
    <v:f eqn="prod @20 @6 @8 "></v:f>
    <v:f eqn="prod @20 @7 @8 "></v:f>
    <v:f eqn="sum @21 #0 0 "></v:f>
    <v:f eqn="sum @22 #1 0 "></v:f>
    <v:f eqn="prod 600 2 1 "></v:f>
    <v:f eqn="sum #0 600 0 "></v:f>
    <v:f eqn="sum #0 0 600 "></v:f>
    <v:f eqn="sum #1 600 0 "></v:f>
    <v:f eqn="sum #1 0 600 "></v:f>
    <v:f eqn="sum @16 @25 0 "></v:f>
    <v:f eqn="sum @16 0 @25 "></v:f>
    <v:f eqn="sum @17 @25 0 "></v:f>
    <v:f eqn="sum @17 0 @25 "></v:f>
    <v:f eqn="sum @23 @12 0 "></v:f>
    <v:f eqn="sum @23 0 @12 "></v:f>
    <v:f eqn="sum @24 @12 0 "></v:f>
    <v:f eqn="sum @24 0 @12 "></v:f>
    <v:f eqn="sum #0 0 0 "></v:f>
    <v:f eqn="sum #1 0 0 "></v:f>
   </v:formulas>
   <v:path o:connectlocs="67,10800;10800,21577;21582,10800;10800,1235;@38,@39" o:extrusionok="f"
    o:connecttype="custom" textboxrect="2977,3262,17087,17337"></v:path>
   <v:handles>
    <v:h position="#0,#1"></v:h>
   </v:handles>
   <o:complex v:ext="view"></o:complex>
  </v:shapetype>
   

 </body>
</html>

