<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<META HTTP-EQUIV="Expires" CONTENT="0">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<title>邮件分类</title>
<script>
    function goto(t){
        self.location.href=t;
    }
	
	
function custinput(t,y){
    var j=eval("document.all."+y)
    if(t.value.substr(0,5)=="$cust"){
        j.value=t.value.substr(16)
        j.disabled=0
       j.focus()
   }else{
      j.value=t.value.substr(16)
     j.disabled=1
  }
}

	
	function gotoPage(pagenum)

{
    form1.CurPg.value = pagenum;
}
    
	function setselect(t,s,v){
       j=t.options.length;
	   k=0;
	   if(v=='') {
       for(i=0;i<j;i++) { 
           gv = t.options[i].value; 
           if(gv.substr(0,5)=="$cust"){
            t.selectedIndex = i;
    		s.value = v;
            s.disabled=0;
		    return;
			}
			}
			}
			else  {
       for(i=0;i<j;i++) { 
           gv = t.options[i].value; 
		   l = v.length;
           if(gv.substr(0,5)=="$cust"){
			        k=i;
           }
           else if(gv.substr(0,l) == v) {
               t.selectedIndex = i;
			   s.value =gv.substr(15);
               s.disabled=1
              return
           }
       }
        t.selectedIndex = k;
		s.value = v;
        s.disabled=0;
		return;
      }
    }
      
   function setselect1(t,v){
       j=t.options.length;
       for(i=0;i<j;i++) { 
           gv = t.options[i].value; 
		   l = v.length;
           if(gv.substr(0,l) == v) {
               t.selectedIndex = i;
           }
       }
    }
      

	function setsave(t){
       j=form1.save.options.length; 
       for(i=0;i<j;i++) { 
           gv = form1.save.options[i].value;
           if(gv == t) {
               form1.save.selectedIndex = i;
           }
       }
    }

	function settzflags(t){
       j=form1.tz.options.length; 
	   for(i=0;i<j;i++) { 
           gv = form1.tz.options[i].value;
           if(gv == t) {
               form1.tz.selectedIndex = i;
			   if(t == '3') {
                     document.all.b1.style.display=""
				}
               else{
                    document.all.b1.style.display="none"			       
			   }
           }
       }
    }
	  
	function setstype(t){
       j=form1.stype.options.length; 
	   for(i=0;i<j;i++) { 
           gv = form1.stype.options[i].value;
           if(gv == t) {
               form1.stype.selectedIndex = i;
           }
       }
    }
	  
	 function setctlflags(t){
       j=form1.ctlflags.options.length; 
	   for(i=0;i<j;i++) { 
           gv = form1.ctlflags.options[i].value;
           if(gv == t) {
               form1.ctlflags.selectedIndex = i;
			   if(t=='3') {
   			        document.all.b0.style.display=""
			   }
			   else {
    	  		   document.all.b0.style.display="none"
			   }
           }
       }
    }
	  
    function mouseovertr2 (o){
        var i;
        df=o.style.backgroundColor
	    o.style.backgroundColor= "#003399";
	    o.style.borderColor= "#FFFF00";
	    o.style.cursor="hand";	
        for(i=0; i<o.cells.length; i++)
        {
	        o.cells(i).style.color="#ffffff";
        }	
    }
    function setinit()
	{
		settzflags('[#tz#]');
		setsave('[#save#]');
		setstype('[#stype#]');
		setctlflags('[#ctlflags#]');
	}

    function showf(index,num,disp,sip,sport,indev,dip,dport,outdev,prot,jump) {
        form1.dispname.value=disp;
        form1.index.value=index;
        form1.runnum.value=num;
		setselect(form1.sip,form1.sipid,sip);
		setselect(form1.sport,form1.sportid,sport);
		setselect(form1.indev,form1.indevid,indev);
		setselect(form1.dip,form1.dipid,dip);
		setselect(form1.dport,form1.dportid,dport);
		setselect(form1.outdev,form1.outdevid,outdev);
		setselect1(form1.prot,prot);
		setselect1(form1.jump,jump);
    }
    
    function mouseouttr2(o){
	    o.style.backgroundColor=df
        for(i=0; i<o.cells.length; i++)
        {
	        o.cells(i).style.color="#000000";
        }
    }

    var dfd1="0"
    function checkme(p)
    {
	    var tt=p.value
	    if (tt>yy)
	    {
		    MM_changeProp('browsdopage','','value',yy,'INPUT/TEXT')
	    }
	    if (tt==0)
	    {
		    MM_changeProp('browsdopage','','value','1','INPUT/TEXT')
	    }
    }

    function allChecked(){
        if(dfd1=="1"){
            dfd1="0"
        }
        else {
             dfd1="1"
        }
	    for(var i=0;i<document.all.DataTable.rows.length;i++)
	    {
		    if(typeof(document.all.DataTable.rows[i].cells[0].childNodes[0])=="object"
				&&document.all.DataTable.rows[i].cells[0].childNodes[0].tagName=="INPUT"
				&&document.all.DataTable.rows[i].cells[0].childNodes[0].type=="checkbox") {
			    if(dfd1=="1"){
  			        document.all.DataTable.rows[i].cells[0].childNodes[0].checked="true";
                }
			    else{
                    document.all.DataTable.rows[i].cells[0].childNodes[0].checked="";
                }
            }
 	    }
    }
    
<!--

function fff(t) { 
  if(t=='0'){
    if(document.all.a0.value==3){
      document.all.b0.style.display=""
    }else{
      document.all.b0.style.display="none"
    }
  }else{
    if(document.all.a1.value==3){
      document.all.b1.style.display=""
    }else if(document.all.a1.value==0){
       document.all.b1.style.display="none"
    }else{
       document.all.b1.style.display="none"
    }
  }
}
//-->
    
<!-- Hide
var ll=[#CurPg#]
var yy=[#TotPg#]
function killErrors() {
   return true;
}

window.onerror = killErrors;
// -->
    function killErrors() {
        return true;
    }
    window.onerror = killErrors;
// -->

</script>

<link REL=stylesheet HREF="/css/runmit.css" TYPE="text/css">
<script src="/js/rmenu.js"></script>
<style type="text/css">
<!--
.tScrollw {

      overflow: scroll;
    overflow-x:hidden;
    height:420px;
    cursor: default;
    }
  tr.tableHead {
    position:relative;
    height: 21px; 
    text-align: center;
    }   
.ttt {  border-style: outset; border-top-width: 2px; border-right-width: 2px; border-bottom-width: 2px; border-left-width: 2px}
.nnoo {  filter: Gray}
-->
</style>
<link rel="stylesheet" href="/css/css.css" type="text/css">
</head>
<body marginheight=0 leftmargin=0 marginwidth=0 topMargin="0" BGCOLOR="#DEE8FA" style="overflow:hidden">
<form name="form1" method="post" action="/pronline/Msg"> 
  <table width=100% border="0" align=center cellpadding="0" cellspacing="0">
    <tr>
      <td valign="top"   >
<table width="100%" height="30" border="0" align="center" cellpadding="0" cellspacing="0" background="/images/images2/chaxun2-1.gif">
          <tr > 
            <td colspan="2"> <div align="center"><div style="font-size:11pt;color:#00237e;font-weight:bold;text-align: center;">包过滤规则设置</div></td>
          </tr>
        </table>
      </td>
    </tr>
    <tr> 
      <td width="100%"   class="ttt" >
          <table width="100%" border="0">
          <tr> 
            <td width="85" height="8"> 
              <p align="right">规则说明</p></td>
            <td colspan="3" height="8"> <input type="text" name="dispname" size="63" maxlength="63"  > 
            </td>
            <td width="107" height="8"> <p align="right">序号</p></td>
            <td width="347" height="8"> <p align="left"> 
                <input type="text" name="runnum" size="6" maxlength="6" >
              </p></td>
          </tr>
          <tr> 
            <td width="85" height="2"> 
              <p align="right">源地址</p></td>
            <td width="312" height="2"> [#sip#]</td>
            <td width="79" height="2"> 
              <p align="right">源端口</p></td>
            <td width="289" height="2"> [#sport#]</td>
            <td width="107" height="2"> <p align="right">源接口</p></td>
            <td width="347" height="2"> [#indev#]</td>
          </tr>
          <tr> 
            <td height="28"> 
              <p align="right">目标地址</p></td>
            <td height="28"> [#dip#]</td>
            <td width="79" height="28"> 
              <p align="right">目标端口</p></td>
            <td width="289" height="28"> [#dport#]</td>
            <td width="107" height="28"> <p align="right">目标接口</p></td>
            <td width="347" height="28"> [#outdev#]</td>
          </tr>
          <tr> 
            <td height="26"> 
              <p align="right">协议名称</p></td>
            <td height="26"> [#prot#]</td>
            <td width="79" height="26"> 
              <p align="right">&nbsp;</p></td>
            <td width="289" height="26">&nbsp; </td>
            <td width="107" height="26"> <p align="right">控制</p></td>
            <td width="347" height="26">[#jump#] </td>
          </tr>

          <tr> 
            <td colspan="6" height="2"> <div align="center"> 
                <table width="92%" border="0" align="right">
                  <tr> 
                    <td width="46%"> <div align="right"> 
                        <input type="hidden" name="CurPg"      value="[#CurPg#]">
                        <input type="hidden" name="TotPg"      value="[#TotPg#]">
                        <input name="add" type="submit" class="an3" value="添 加" >
                        <input name="modi" type="submit" class="an3" value="修 改" >
                        <input name="save" type="submit" class="an3" value="保 存" >
                        <input name="del" type="submit" class="an3" value="删 除" >
                        <input type="hidden" name="FunName" value="fireWebRuleEdit">
                        <input type="hidden" name="index"   value="">
                      </div></td>
                    <td width="54%"> <table align=right border=0 cellpadding=0 cellspacing=0 class=main width=111>
                        <tbody>
                        <td width="10%"> <script>
                      if (ll==1){
                        document.write("<img src='/images/zbuyer-06.gif' border=0 height=17 width=35 class='gray1'>")}
                      else{
                        document.write("<a href='#'><img src='/images/zbuyer-06.gif' border=0 height=17 width=35 onClick='gotoPage(1);form1.submit()' class='hand'>")}
                   </script> </td>
                        <td width="10%"> <script>
                      if (ll==1){
                        document.write("<img src='/images/zbuyer-03.gif' border=0 height=17 width=20 class='gray1'>")}
                      else {
                        document.write("<img src='/images/zbuyer-03.gif' border=0 height=17 width=20 onClick='gotoPage([#CurPg#]-1);form1.submit()' class='hand'>")}
                   </script> </td>
                        <td width="20%" valign="top"><img src="/images/zbuyer-08.gif" border=0 height=17 width=32></td>
                        <td align=middle background="" width=92> <input class=Main id=browsdopage2 maxlength=3  name=browsdopage size=3 style="FONT-SIZE: 12px; HEIGHT: 18px; TEXT-ALIGN: center; WIDTH: 50px" value=[#CurPg#] onKeyPress="if (event.keyCode < 48 || event.keyCode > 57) event.returnValue = false;" onBlur="checkme(this)"> 
                        </td>
                        <td width="10%" valign="top"><img src="/images/zbuyer-09.gif" border=0 height=17 width=16></td>
                        <td width="10%" valign="top"><img align=middle border=0 height=17 src="/images/zbuyer-10.gif" width=17 onClick="gotoPage(form1.browsdopage.value);form1.submit()" class="hand"><img align=middle height=17 src="/images/zbuyer-11.gif" width=3></td>
                        <td width="10%" valign="top"><img border=0 height=17 src="/images/zin1.gif" width=17 ></td>
                        <td align=middle background="" width=92> <input  class=Main id=browsdopage12 maxlength=6 name=browsdopage12 size=6 style="FONT-SIZE: 12px; HEIGHT: 18px; TEXT-ALIGN: center; WIDTH: 50px" value='[#TotPg#]'> 
                        </td>
                        <td width="10%" valign="top"><img align=middle height=17 src="/images/zbuyer-09.gif" width=16></td>
                        <td align=middle background="" width=92> <input  class=Main id=browsdopage12 maxlength=5 name=browsdopage12 size=3 style="FONT-SIZE: 12px; HEIGHT: 18px; TEXT-ALIGN: center; WIDTH: 50px" value='[#TotRec#]'> 
                        </td>
                        <td width="10%" valign="top"><img border=0 height=17 src="/images/zin3.gif" width=17 align="middle" ><img align=middle height=17  src="/images/zbuyer-11.gif" width=3></td>
                        <td width="10%"> <script>
                        if (ll==yy){
                            document.write("<img src='/images/zbuyer-04.gif' border=0 height=17 width=20 class='gray1'>")}
                        else if (yy==0){
                            document.write("<img src='/images/zbuyer-04.gif' border=0 height=17 width=20 class='gray1'>")}
                        else{
                            document.write("<img src='/images/zbuyer-04.gif' border=0 height=17 width=20 onClick='gotoPage([#CurPg#]+1);form1.submit()' class='hand'>")}
                    </script> </td>
                        <td width="10%"> <script>
                        if (ll==yy){
                            document.write("<img src='/images/zbuyer-05.gif' border=0 height=17 width=36 class='gray1'>")}
                        else if (yy==0){
                            document.write("<img src='/images/zbuyer-05.gif' border=0 height=17 width=36 class='gray1'>")}
                        else{
                            document.write("<img src='/images/zbuyer-05.gif' border=0 height=17 width=36 onClick='gotoPage([#TotPg#]);form1.submit()' class='hand'>")}
                    </script> </td>
                      </table></td>
                  </tr>
                </table>
              </div></td>
          </tr>
        </table> </td>
    </tr>
    <tr> 
      <td width="100%"  valign=top align=center> 
      	<div class="tScrollw"  id="tC">
      	<table  id="DataTable" width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#FFFFFF" >
          <tr bgcolor="#6382BD"  height="21" class="tableHead" style="top:expression(document.getElementById('tC').scrollTop)"> 
            <td width="40" height="18" class="bord2"> <div align="center"><font color="#FFFFFF"> 
                <input type="button" name="b1" value="全选"    class="anniu_1" onClick="allChecked()">
                </font></div></td>
            <td height="18" class="bord2"> <div align="center"><font color="#FFFFFF">序号</font></div></td>
            <td height="18" class="bord2"> <div align="center"><font color="#FFFFFF">说明</font></div></td>
            <td height="18" class="bord2"> <div align="center"><font color="#FFFFFF"> 
                内容</font></div></td>
          </tr>
          <!-- [#SLPB#] -->
          <tr onMouseOver="mouseovertr2(this)" onMouseOut="mouseouttr2(this)" onclick="showf('[#lindex#]','[#lrunnum#]','[#ldispname#]','[#lsip#]','[#lsport#]','[#lindev#]','[#ldip#]','[#ldport#]' ,'[#loutdev#]','[#lprot#]','[#ljump#]')"> 
            <td class="bord1" width="40"> 
              <input type="checkbox" name="ch[#num#]" value="[#lindex#]">
            </td>
            <td class="bord1">&nbsp;[#lrunnum#]</td>
            <td class="bord1">&nbsp;[#ldispname#]</td>
            <td class="bord3">&nbsp;[#ldes#]</td>
          </tr>
          <!-- [#SLPE#] -->
          <!-- [#SLPB#] -->
          <tr id=[#snum#] height="18px"> 
            <td width="40" class="bord1">&nbsp; </td>
            <td class="bord1">&nbsp;</td>
            <td class="bord1">&nbsp;</td>
            <td class="bord3">&nbsp;</td>
          </tr>
          <!-- [#SLPE#] -->
        </table>
      </div>
      </td>
    </tr>
     
  </table>
  </form>
</body>
</html>